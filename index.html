<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Truevestments - AI-Powered Life Infrastructure Management</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet">
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: 'Inter', sans-serif; background: #000; color: #fff; }
        .animate-slideUp { animation: slideUp 0.3s ease; }
        @keyframes slideUp { from { opacity: 0; transform: translateY(20px); } to { opacity: 1; transform: translateY(0); } }
    </style>
</head>
<body>
    <div id="app"></div>

    <script>
        // State Management
        let state = {
            currentPage: 'home',
            currentSubPage: { personal: 'personal-auto', business: 'business-dashboard' },
            chatOpen: false,
            voiceOpen: false,
            chatMessages: [{ isUser: false, message: "Hi! I'm your AI assistant. Ask about portfolio, insurance, refinancing, or net worth." }],
            cryptoData: {},
            stockData: {},
            vinInput: '',
            vinResults: null,
            homeSearch: '',
            homePriceFilter: '',
            vehicleSearch: '',
            vehiclePriceFilter: '',
            vehicleTypeFilter: ''
        };

        // Configuration
        const CRYPTO_HOLDINGS = { bitcoin: 0.75, ethereum: 12 };
        const STOCK_HOLDINGS = {
            AAPL: { shares: 150, costBasis: 162.00 },
            GOOGL: { shares: 50, costBasis: 102.40 },
            TSLA: { shares: 100, costBasis: 244.00 }
        };

        const AI_RESPONSES = {
            'portfolio': 'Based on your holdings: $28,575 stocks, ~$32K crypto, $228K retirement. Total: ~$288K. Tech-heavy at 68%!',
            'insurance': 'Found $1,280 annual savings! Auto: -$420/yr, Home: -$380/yr.',
            'refinance': 'Your $220K equity qualifies for 3.75%! Save $288/month.',
            'vehicle': 'Your CR-V has $11,300 equity. Trade for Accord Hybrid: $410/mo.',
            'net worth': 'Total: $796,325 (Home $220K, Retirement $228K, Business $277K)',
            'default': 'I can help with: portfolio, insurance, refinancing, vehicles, or business.'
        };

        const mockHomes = [
            { id: 1, address: "456 Maple St, Atlanta 30309", price: 485000, beds: 3, baths: 2.5, sqft: 2150, yearBuilt: 2018, description: "Modern townhome", source: "Zillow", daysOnMarket: 12 },
            { id: 2, address: "789 Peachtree Rd, Atlanta 30326", price: 695000, beds: 4, baths: 3, sqft: 2800, yearBuilt: 2020, description: "Luxury home", source: "Redfin", daysOnMarket: 5 }
        ];

        const mockVehicles = [
            { id: 1, year: 2022, make: "Honda", model: "CR-V", trim: "EX-L", price: 32500, mileage: 15420, type: "suv", description: "Excellent condition", source: "AutoTrader", mpg: "28/34", carfaxScore: 4.8 },
            { id: 2, year: 2023, make: "Toyota", model: "Camry", trim: "XLE", price: 28900, mileage: 8950, type: "sedan", description: "Like new", source: "KBB", mpg: "32/41", carfaxScore: 4.9 }
        ];

        // API Functions
        async function fetchCryptoPrices() {
            try {
                const response = await fetch('https://api.coingecko.com/api/v3/simple/price?ids=bitcoin,ethereum,solana,litecoin,ripple&vs_currencies=usd&include_24hr_change=true&include_market_cap=true');
                if (!response.ok) throw new Error('API failed');
                state.cryptoData = await response.json();
            } catch (error) {
                state.cryptoData = {
                    bitcoin: { usd: 108000, usd_24h_change: 2.5, usd_market_cap: 2.1e12 },
                    ethereum: { usd: 4200, usd_24h_change: 3.2, usd_market_cap: 5e11 },
                    solana: { usd: 250, usd_24h_change: 5.1, usd_market_cap: 1.2e11 },
                    litecoin: { usd: 110, usd_24h_change: 1.8, usd_market_cap: 8.2e9 },
                    ripple: { usd: 3.20, usd_24h_change: 4.2, usd_market_cap: 1.85e11 }
                };
            }
        }

        function fetchStockPrices() {
            const now = new Date();
            const isOpen = now.getDay() !== 0 && now.getDay() !== 6 && now.getHours() >= 9 && now.getHours() < 16;
            state.stockData = {
                AAPL: { price: 190.50 + Math.random() * 10, change: (Math.random() - 0.5) * 6 },
                GOOGL: { price: 141.20 + Math.random() * 8, change: (Math.random() - 0.5) * 5 },
                TSLA: { price: 183.45 + Math.random() * 15, change: (Math.random() - 0.5) * 8 }
            };
            state.marketStatus = isOpen ? 'â— Open' : 'â— Closed';
        }

        async function scanVIN() {
            const vin = state.vinInput.toUpperCase().trim();
            if (vin.length !== 17 || !/^[A-HJ-NPR-Z0-9]{17}$/.test(vin)) {
                state.vinResults = { error: 'Invalid VIN (17 chars, no I/O/Q)' };
                render();
                return;
            }
            state.vinResults = { loading: true };
            render();
            try {
                const res = await fetch(`https://vpic.nhtsa.dot.gov/api/vehicles/decodevin/${vin}?format=json`);
                const data = await res.json();
                if (data.Results?.length) {
                    const get = (v) => data.Results.find(r => r.Variable === v)?.Value || 'N/A';
                    state.vinResults = {
                        success: true,
                        make: get('Make'),
                        model: get('Model'),
                        year: get('Model Year'),
                        bodyType: get('Body Class'),
                        engine: get('Engine Model'),
                        manufacturer: get('Manufacturer Name'),
                        fuelType: get('Fuel Type - Primary'),
                        plantCountry: get('Plant Country')
                    };
                } else {
                    state.vinResults = { error: 'VIN not found' };
                }
            } catch {
                state.vinResults = { error: 'NHTSA API failed' };
            }
            render();
        }

        function getAIResponse(msg) {
            const m = msg.toLowerCase();
            for (const [key, res] of Object.entries(AI_RESPONSES)) {
                if (m.includes(key)) return res;
            }
            return AI_RESPONSES.default;
        }

        function sendChatMessage() {
            const input = document.getElementById('chatInput');
            const message = input.value.trim();
            if (!message) return;
            
            state.chatMessages.push({ isUser: true, message });
            input.value = '';
            render();
            
            setTimeout(() => {
                state.chatMessages.push({ isUser: false, message: getAIResponse(message) });
                render();
                document.getElementById('chatBody').scrollTop = 999999;
            }, 1000);
        }

        function getFilteredHomes() {
            let filtered = mockHomes;
            if (state.homeSearch) {
                filtered = filtered.filter(h => h.address.toLowerCase().includes(state.homeSearch.toLowerCase()) || h.description.toLowerCase().includes(state.homeSearch.toLowerCase()));
            }
            if (state.homePriceFilter) {
                const [min, max] = state.homePriceFilter.split('-').map(Number);
                filtered = filtered.filter(h => h.price >= min && h.price <= max);
            }
            return filtered;
        }

        function getFilteredVehicles() {
            let filtered = mockVehicles;
            if (state.vehicleSearch) {
                filtered = filtered.filter(v => `${v.year} ${v.make} ${v.model}`.toLowerCase().includes(state.vehicleSearch.toLowerCase()));
            }
            if (state.vehiclePriceFilter) {
                const [min, max] = state.vehiclePriceFilter.split('-').map(Number);
                filtered = filtered.filter(v => v.price >= min && v.price <= max);
            }
            if (state.vehicleTypeFilter) {
                filtered = filtered.filter(v => v.type === state.vehicleTypeFilter);
            }
            return filtered;
        }

        // Icons
        const icons = {
            shield: '<svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m5.618-4.016A11.955 11.955 0 0112 2.944a11.955 11.955 0 01-8.618 3.04A12.02 12.02 0 003 9c0 5.591 3.824 10.29 9 11.622 5.176-1.332 9-6.03 9-11.622 0-1.042-.133-2.052-.382-3.016z"/></svg>',
            home: '<svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 12l2-2m0 0l7-7 7 7M5 10v10a1 1 0 001 1h3m10-11l2 2m-2-2v10a1 1 0 01-1 1h-3m-6 0a1 1 0 001-1v-4a1 1 0 011-1h2a1 1 0 011 1v4a1 1 0 001 1m-6 0h6"/></svg>',
            user: '<svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"/></svg>',
            building: '<svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16m14 0h2m-2 0h-5m-9 0H3m2 0h5M9 7h1m-1 4h1m4-4h1m-1 4h1m-5 10v-5a1 1 0 011-1h2a1 1 0 011 1v5m-4 0h4"/></svg>',
            trending: '<svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 7h8m0 0v8m0-8l-8 8-4-4-6 6"/></svg>',
            car: '<svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 17a2 2 0 11-4 0 2 2 0 014 0zM19 17a2 2 0 11-4 0 2 2 0 014 0z"/><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 16V6a1 1 0 00-1-1H4a1 1 0 00-1 1v10a1 1 0 001 1h1m8-1a1 1 0 01-1 1H9m4-1V8a1 1 0 011-1h2.586a1 1 0 01.707.293l3.414 3.414a1 1 0 01.293.707V16a1 1 0 01-1 1h-1m-6-1a1 1 0 001 1h3.5m-5.5 0h5.5"/></svg>',
            chat: '<svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z"/></svg>',
            mic: '<svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 11a7 7 0 01-7 7m0 0a7 7 0 01-7-7m7 7v4m0 0H8m4 0h4m-4-8a3 3 0 01-3-3V5a3 3 0 116 0v6a3 3 0 01-3 3z"/></svg>',
            x: '<svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"/></svg>',
            sparkles: '<svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 3v4M3 5h4M6 17v4m-2-2h4m5-16l2.286 6.857L21 12l-5.714 2.143L13 21l-2.286-6.857L5 12l5.714-2.143L13 3z"/></svg>'
        };

        // Render Function
        function render() {
            const app = document.getElementById('app');
            
            let mainContent = '';
            
            // HOME PAGE
            if (state.currentPage === 'home') {
                mainContent = `
                    <div class="text-center py-12">
                        <h1 class="text-5xl font-bold text-yellow-600 mb-4">AI-Powered Life Infrastructure</h1>
                        <p class="text-xl text-gray-400 max-w-3xl mx-auto mb-8">
                            The first platform that organizes, monitors, and optimizes your complete financial ecosystem
                        </p>
                        <button onclick="setPage('personal')" class="bg-yellow-600 text-black px-8 py-3 rounded-lg font-bold hover:bg-yellow-700">
                            Get Started
                        </button>
                    </div>
                    <div class="bg-gradient-to-r from-yellow-600/5 border border-yellow-600/20 rounded-xl p-6 mt-8">
                        <h3 class="text-xl font-bold text-white mb-4 flex items-center">
                            ${icons.sparkles}
                            <span class="ml-2">AI Insights & Recommendations</span>
                        </h3>
                        <div class="space-y-3">
                            <div class="bg-black/50 border-l-4 border-yellow-600 rounded-lg p-4">
                                <strong class="text-yellow-600">Critical Alert:</strong> GL policy expires in 15 days. Found 20% cost reduction.
                            </div>
                            <div class="bg-black/50 border-l-4 border-yellow-600 rounded-lg p-4">
                                <strong class="text-yellow-600">Vehicle:</strong> Tesla Model Y could save $2,400/yr fuel + 15% insurance.
                            </div>
                            <div class="bg-black/50 border-l-4 border-yellow-600 rounded-lg p-4">
                                <strong class="text-yellow-600">Portfolio:</strong> Overweight tech. Reallocate 15% to value stocks.
                            </div>
                        </div>
                    </div>
                `;
            }
            
            // INVESTMENTS PAGE
            else if (state.currentPage === 'investments') {
                const btcValue = CRYPTO_HOLDINGS.bitcoin * (state.cryptoData.bitcoin?.usd || 0);
                const ethValue = CRYPTO_HOLDINGS.ethereum * (state.cryptoData.ethereum?.usd || 0);
                
                mainContent = `
                    <h2 class="text-3xl font-bold text-yellow-600 mb-6 flex items-center justify-between">
                        <span>Investment Portfolio</span>
                        <span class="text-sm font-semibold text-gray-400">${state.marketStatus || 'Loading...'}</span>
                    </h2>
                    
                    <!-- Stock Portfolio -->
                    <div class="bg-black rounded-xl border border-yellow-600/20 p-6 mb-6">
                        <h3 class="text-xl font-bold text-white mb-4">Stock Portfolio</h3>
                        <div class="overflow-x-auto">
                            <table class="w-full">
                                <thead class="bg-yellow-600/10">
                                    <tr>
                                        <th class="px-4 py-3 text-left text-xs font-semibold text-yellow-600 uppercase">Symbol</th>
                                        <th class="px-4 py-3 text-left text-xs font-semibold text-yellow-600 uppercase">Shares</th>
                                        <th class="px-4 py-3 text-left text-xs font-semibold text-yellow-600 uppercase">Price</th>
                                        <th class="px-4 py-3 text-left text-xs font-semibold text-yellow-600 uppercase">Value</th>
                                        <th class="px-4 py-3 text-left text-xs font-semibold text-yellow-600 uppercase">Day Gain</th>
                                    </tr>
                                </thead>
                                <tbody class="divide-y divide-yellow-600/20">
                                    ${Object.keys(STOCK_HOLDINGS).map(symbol => {
                                        const holding = STOCK_HOLDINGS[symbol];
                                        const stock = state.stockData[symbol] || { price: 0, change: 0 };
                                        const value = holding.shares * stock.price;
                                        const dayGain = holding.shares * stock.change;
                                        const changePercent = (stock.change / stock.price) * 100;
                                        const gainColor = dayGain >= 0 ? 'text-green-400' : 'text-red-400';
                                        
                                        return `
                                            <tr class="hover:bg-yellow-600/5">
                                                <td class="px-4 py-4 font-semibold text-white">${symbol}</td>
                                                <td class="px-4 py-4 text-gray-400">${holding.shares}</td>
                                                <td class="px-4 py-4">
                                                    <div class="${gainColor}">$${stock.price.toFixed(2)}</div>
                                                    <div class="text-xs text-gray-500">${changePercent >= 0 ? '+' : ''}${changePercent.toFixed(2)}%</div>
                                                </td>
                                                <td class="px-4 py-4 text-white">$${value.toFixed(2)}</td>
                                                <td class="px-4 py-4 font-semibold ${gainColor}">
                                                    ${dayGain >= 0 ? '+' : ''}$${Math.abs(dayGain).toFixed(2)}
                                                </td>
                                            </tr>
                                        `;
                                    }).join('')}
                                </tbody>
                            </table>
                        </div>
                    </div>
                    
                    <!-- Retirement -->
                    <div class="bg-black rounded-xl border border-yellow-600/20 p-6 mb-6">
                        <h3 class="text-xl font-bold text-white mb-4">Retirement Accounts</h3>
                        <div class="space-y-3">
                            <div class="flex justify-between py-3 border-b border-yellow-600/10">
                                <span class="text-gray-400">401(k) Balance</span>
                                <span class="font-semibold text-white">$185,250.00</span>
                            </div>
                            <div class="flex justify-between py-3 border-b border-yellow-600/10">
                                <span class="text-gray-400">ROTH IRA Balance</span>
                                <span class="font-semibold text-white">$42,800.00</span>
                            </div>
                            <div class="flex justify-between py-3">
                                <span class="text-gray-400">Total Retirement Assets</span>
                                <span class="font-semibold text-green-400">$228,050.00</span>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Crypto -->
                    <div class="bg-black rounded-xl border border-yellow-600/20 p-6 mb-6">
                        <h3 class="text-xl font-bold text-white mb-4">Digital Assets</h3>
                        <div class="space-y-3">
                            <div class="flex justify-between py-3 border-b border-yellow-600/10">
                                <span class="text-gray-400">Bitcoin (BTC)</span>
                                <div class="text-right">
                                    <div class="font-semibold text-green-400">${CRYPTO_HOLDINGS.bitcoin} BTC (~$${btcValue.toFixed(2)})</div>
                                    <div class="text-xs text-gray-500">$${(state.cryptoData.bitcoin?.usd || 0).toFixed(2)}</div>
                                </div>
                            </div>
                            <div class="flex justify-between py-3 border-b border-yellow-600/10">
                                <span class="text-gray-400">Ethereum (ETH)</span>
                                <div class="text-right">
                                    <div class="font-semibold text-green-400">${CRYPTO_HOLDINGS.ethereum} ETH (~$${ethValue.toFixed(2)})</div>
                                    <div class="text-xs text-gray-500">$${(state.cryptoData.ethereum?.usd || 0).toFixed(2)}</div>
                                </div>
                            </div>
                            <div class="flex justify-between py-3">
                                <span class="text-gray-400">Total Crypto Assets</span>
                                <span class="font-semibold text-green-400">~$${(btcValue + ethValue).toFixed(2)}</span>
                            </div>
                        </div>
                    </div>
                `;
            }
            
            // PERSONAL PAGE
            else if (state.currentPage === 'personal') {
                const subNav = `
                    <div class="flex flex-wrap gap-2 border-b border-yellow-600/20 pb-4 mb-6">
                        <button onclick="setSubPage('personal', 'personal-auto')" class="px-4 py-2 rounded-lg font-semibold text-sm flex items-center space-x-2 ${state.currentSubPage.personal === 'personal-auto' ? 'text-yellow-600 bg-yellow-600/10' : 'text-gray-400 hover:text-white'}">
                            ${icons.car}<span>Auto</span>
                        </button>
                        <button onclick="setSubPage('personal', 'personal-home')" class="px-4 py-2 rounded-lg font-semibold text-sm flex items-center space-x-2 ${state.currentSubPage.personal === 'personal-home' ? 'text-yellow-600 bg-yellow-600/10' : 'text-gray-400 hover:text-white'}">
                            ${icons.home}<span>Home</span>
                        </button>
                        <button onclick="setSubPage('personal', 'personal-insurance')" class="px-4 py-2 rounded-lg font-semibold text-sm flex items-center space-x-2 ${state.currentSubPage.personal === 'personal-insurance' ? 'text-yellow-600 bg-yellow-600/10' : 'text-gray-400 hover:text-white'}">
                            ${icons.shield}<span>Insurance</span>
                        </button>
                    </div>
                `;
                
                if (state.currentSubPage.personal === 'personal-auto') {
                    mainContent = subNav + `
                        <h2 class="text-3xl font-bold text-yellow-600 mb-6">Personal Auto Hub</h2>
                        
                        <!-- Primary Vehicle -->
                        <div class="bg-black rounded-xl border border-yellow-600/20 p-6 mb-6">
                            <h3 class="text-xl font-bold text-white mb-4">Primary Vehicle: 2022 Honda CR-V</h3>
                            <div class="grid grid-cols-1 sm:grid-cols-2 gap-4">
                                <div class="flex justify-between py-2 border-b border-yellow-600/10">
                                    <span class="text-gray-400">VIN</span>
                                    <span class="text-white font-semibold">1HG...789</span>
                                </div>
                                <div class="flex justify-between py-2 border-b border-yellow-600/10">
                                    <span class="text-gray-400">Mileage</span>
                                    <span class="text-white font-semibold">28,500 miles</span>
                                </div>
                                <div class="flex justify-between py-2 border-b border-yellow-600/10">
                                    <span class="text-gray-400">Est. Market Value</span>
                                    <span class="text-green-400 font-semibold">$29,500</span>
                                </div>
                                <div class="flex justify-between py-2 border-b border-yellow-600/10">
                                    <span class="text-gray-400">Loan Balance</span>
                                    <span class="text-yellow-400 font-semibold">$18,200</span>
                                </div>
                                <div class="flex justify-between py-2">
                                    <span class="text-gray-400">Estimated Equity</span>
                                    <span class="text-green-400 font-semibold">$11,300</span>
                                </div>
                            </div>
                        </div>
                        
                        <!-- VIN Decoder -->
                        <div class="bg-black rounded-xl border border-yellow-600/20 p-6 mb-6">
                            <h3 class="text-xl font-bold text-white mb-3">VIN Decoder</h3>
                            <p class="text-gray-400 mb-4">Enter any VIN to analyze vehicle specifications from NHTSA database.</p>
                            <div class="flex gap-3 mb-4">
                                <input type="text" id="vinInput" value="${state.vinInput}" oninput="state.vinInput=this.value" placeholder="Enter VIN (17 characters)..." maxlength="17" class="flex-1 px-4 py-2 bg-gray-900 border border-yellow-600/20 rounded-lg text-white placeholder-gray-500">
                                <button onclick="scanVIN()" class="px-6 py-2 bg-yellow-600 text-black rounded-lg font-semibold hover:bg-yellow-700">Analyze</button>
                            </div>
                            ${state.vinResults ? `
                                <div class="bg-gray-900 border border-yellow-600/20 rounded-lg p-4">
                                    ${state.vinResults.error ? `<div class="text-red-400">${state.vinResults.error}</div>` : ''}
                                    ${state.vinResults.loading ? `<div class="text-yellow-600">Querying NHTSA...</div>` : ''}
                                    ${state.vinResults.success ? `
                                        <h4 class="text-yellow-600 font-bold mb-3">âœ“ Vehicle Decoded</h4>
                                        <div class="grid grid-cols-2 gap-3 text-sm">
                                            <div class="flex justify-between py-2 border-b border-yellow-600/10">
                                                <span class="text-gray-400">Make:</span>
                                                <span class="text-white font-semibold">${state.vinResults.make}</span>
                                            </div>
                                            <div class="flex justify-between py-2 border-b border-yellow-600/10">
                                                <span class="text-gray-400">Model:</span>
                                                <span class="text-white font-semibold">${state.vinResults.model}</span>
                                            </div>
                                            <div class="flex justify-between py-2 border-b border-yellow-600/10">
                                                <span class="text-gray-400">Year:</span>
                                                <span class="text-white font-semibold">${state.vinResults.year}</span>
                                            </div>
                                            <div class="flex justify-between py-2 border-b border-yellow-600/10">
                                                <span class="text-gray-400">Body Type:</span>
                                                <span class="text-white font-semibold">${state.vinResults.bodyType}</span>
                                            </div>
                                        </div>
                                    ` : ''}
                                </div>
                            ` : ''}
                        </div>
                        
                        <!-- Vehicles for Sale -->
                        <div class="bg-black rounded-xl border border-yellow-600/20 p-6">
                            <h3 class="text-xl font-bold text-white mb-3">Vehicles for Sale</h3>
                            <div class="flex gap-3 mb-4">
                                <input type="text" value="${state.vehicleSearch}" oninput="state.vehicleSearch=this.value; render()" placeholder="Search..." class="flex-1 px-4 py-2 bg-gray-900 border border-yellow-600/20 rounded-lg text-white placeholder-gray-500 text-sm">
                                <select onchange="state.vehiclePriceFilter=this.value; render()" class="px-4 py-2 bg-gray-900 border border-yellow-600/20 rounded-lg text-white text-sm">
                                    <option value="">All Prices</option>
                                    <option value="0-25000">Under $25K</option>
                                    <option value="25000-40000">$25K - $40K</option>
                                    <option value="40000-99999999">Over $40K</option>
                                </select>
                            </div>
                            <div class="space-y-4">
                                ${getFilteredVehicles().map(v => `
                                    <div class="bg-gray-900 border border-yellow-600/10 rounded-lg p-4 flex gap-4">
                                        <div class="flex-1">
                                            <h4 class="text-yellow-600 font-bold mb-2">${v.year} ${v.make} ${v.model} ${v.trim}</h4>
                                            <p class="text-gray-400 text-sm mb-2">${v.description}</p>
                                            <div class="flex gap-4 text-xs text-gray-500">
                                                <span>${v.mileage.toLocaleString()} miles</span>
                                                <span>${v.mpg} MPG</span>
                                                <span>â˜… ${v.carfaxScore}/5.0</span>
                                            </div>
                                        </div>
                                        <div class="text-right">
                                            <div class="text-2xl font-bold text-green-400 mb-1">$${v.price.toLocaleString()}</div>
                                            <div class="text-xs text-gray-500">via ${v.source}</div>
                                        </div>
                                    </div>
                                `).join('')}
                            </div>
                        </div>
                    `;
                } else if (state.currentSubPage.personal === 'personal-home') {
                    mainContent = subNav + `
                        <h2 class="text-3xl font-bold text-yellow-600 mb-6">Personal Home Management</h2>
                        
                        <div class="bg-black rounded-xl border border-yellow-600/20 p-6 mb-6">
                            <h3 class="text-xl font-bold text-white mb-4">123 Peachtree Lane, Atlanta, GA</h3>
                            <div class="grid grid-cols-1 sm:grid-cols-2 gap-4">
                                <div class="flex justify-between py-3 border-b border-yellow-600/10">
                                    <span class="text-gray-400">AI-Estimated Value</span>
                                    <span class="text-green-400 font-semibold">$535,000</span>
                                </div>
                                <div class="flex justify-between py-3 border-b border-yellow-600/10">
                                    <span class="text-gray-400">Mortgage Balance</span>
                                    <span class="text-white font-semibold">$315,000</span>
                                </div>
                                <div class="flex justify-between py-3 border-b border-yellow-600/10">
                                    <span class="text-gray-400">Estimated Equity</span>
                                    <span class="text-green-400 font-semibold">$220,000</span>
                                </div>
                                <div class="flex justify-between py-3">
                                    <span class="text-gray-400">Current Interest Rate</span>
                                    <span class="text-yellow-400 font-semibold">4.15%</span>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Homes for Sale -->
                        <div class="bg-black rounded-xl border border-yellow-600/20 p-6">
                            <h3 class="text-xl font-bold text-white mb-3">Homes for Sale</h3>
                            <div class="flex gap-3 mb-4">
                                <input type="text" value="${state.homeSearch}" oninput="state.homeSearch=this.value; render()" placeholder="Search..." class="flex-1 px-4 py-2 bg-gray-900 border border-yellow-600/20 rounded-lg text-white placeholder-gray-500 text-sm">
                                <select onchange="state.homePriceFilter=this.value; render()" class="px-4 py-2 bg-gray-900 border border-yellow-600/20 rounded-lg text-white text-sm">
                                    <option value="">All Prices</option>
                                    <option value="0-500000">Under $500K</option>
                                    <option value="500000-700000">$500K - $700K</option>
                                    <option value="700000-99999999">Over $700K</option>
                                </select>
                            </div>
                            <div class="space-y-4">
                                ${getFilteredHomes().map(h => `
                                    <div class="bg-gray-900 border border-yellow-600/10 rounded-lg p-4 flex gap-4">
                                        <div class="flex-1">
                                            <h4 class="text-yellow-600 font-bold mb-2">${h.address}</h4>
                                            <p class="text-gray-400 text-sm mb-2">${h.description}</p>
                                            <div class="flex gap-4 text-xs text-gray-500">
                                                <span>${h.beds} bed</span>
                                                <span>${h.baths} bath</span>
                                                <span>${h.sqft.toLocaleString()} sqft</span>
                                                <span>Built ${h.yearBuilt}</span>
                                            </div>
                                        </div>
                                        <div class="text-right">
                                            <div class="text-2xl font-bold text-green-400 mb-1">$${h.price.toLocaleString()}</div>
                                            <div class="text-xs text-gray-500">${h.daysOnMarket} days</div>
                                            <div class="text-xs text-yellow-600">via ${h.source}</div>
                                        </div>
                                    </div>
                                `).join('')}
                            </div>
                        </div>
                    `;
                } else if (state.currentSubPage.personal === 'personal-insurance') {
                    mainContent = subNav + `
                        <h2 class="text-3xl font-bold text-yellow-600 mb-6">Personal Insurance</h2>
                        <div class="bg-black rounded-xl border border-yellow-600/20 p-6">
                            <h3 class="text-xl font-bold text-white mb-4">Coverage Summary</h3>
                            <div class="space-y-3">
                                <div class="flex justify-between py-3 border-b border-yellow-600/10">
                                    <span class="text-gray-400">Active Policies</span>
                                    <span class="text-white font-semibold">6</span>
                                </div>
                                <div class="flex justify-between py-3 border-b border-yellow-600/10">
                                    <span class="text-gray-400">Annual Premium</span>
                                    <span class="text-white font-semibold">$8,940</span>
                                </div>
                                <div class="flex justify-between py-3">
                                    <span class="text-gray-400">Potential Savings</span>
                                    <span class="text-green-400 font-semibold">$1,280/year</span>
                                </div>
                            </div>
                        </div>
                    `;
                }
            }
            
            // BUSINESS PAGE
            else if (state.currentPage === 'business') {
                const subNav = `
                    <div class="flex flex-wrap gap-2 border-b border-yellow-600/20 pb-4 mb-6">
                        <button onclick="setSubPage('business', 'business-dashboard')" class="px-4 py-2 rounded-lg font-semibold text-sm ${state.currentSubPage.business === 'business-dashboard' ? 'text-yellow-600 bg-yellow-600/10' : 'text-gray-400 hover:text-white'}">
                            Dashboard
                        </button>
                        <button onclick="setSubPage('business', 'business-fleet')" class="px-4 py-2 rounded-lg font-semibold text-sm ${state.currentSubPage.business === 'business-fleet' ? 'text-yellow-600 bg-yellow-600/10' : 'text-gray-400 hover:text-white'}">
                            Fleet
                        </button>
                        <button onclick="setSubPage('business', 'business-property')" class="px-4 py-2 rounded-lg font-semibold text-sm ${state.currentSubPage.business === 'business-property' ? 'text-yellow-600 bg-yellow-600/10' : 'text-gray-400 hover:text-white'}">
                            Property
                        </button>
                        <button onclick="setSubPage('business', 'business-insurance')" class="px-4 py-2 rounded-lg font-semibold text-sm ${state.currentSubPage.business === 'business-insurance' ? 'text-yellow-600 bg-yellow-600/10' : 'text-gray-400 hover:text-white'}">
                            Insurance
                        </button>
                    </div>
                `;
                
                if (state.currentSubPage.business === 'business-dashboard') {
                    mainContent = subNav + `
                        <h2 class="text-3xl font-bold text-yellow-600 mb-6">Business Dashboard</h2>
                        <div class="bg-black rounded-xl border border-yellow-600/20 p-6">
                            <h3 class="text-xl font-bold text-white mb-4">Key Metrics</h3>
                            <div class="grid grid-cols-2 gap-4">
                                <div class="flex justify-between py-3 border-b border-yellow-600/10">
                                    <span class="text-gray-400">Annual Revenue</span>
                                    <span class="text-green-400 font-semibold">$1,247,000</span>
                                </div>
                                <div class="flex justify-between py-3 border-b border-yellow-600/10">
                                    <span class="text-gray-400">Net Profit</span>
                                    <span class="text-green-400 font-semibold">$485,200</span>
                                </div>
                                <div class="flex justify-between py-3">
                                    <span class="text-gray-400">Active Employees</span>
                                    <span class="text-white font-semibold">24</span>
                                </div>
                                <div class="flex justify-between py-3">
                                    <span class="text-gray-400">Growth Rate</span>
                                    <span class="text-green-400 font-semibold">+15.2%</span>
                                </div>
                            </div>
                        </div>
                    `;
                } else if (state.currentSubPage.business === 'business-fleet') {
                    mainContent = subNav + `
                        <h2 class="text-3xl font-bold text-yellow-600 mb-6">Commercial Fleet</h2>
                        <div class="bg-black rounded-xl border border-yellow-600/20 p-6">
                            <table class="w-full">
                                <thead class="bg-yellow-600/10">
                                    <tr>
                                        <th class="px-4 py-3 text-left text-xs font-semibold text-yellow-600 uppercase">Vehicle</th>
                                        <th class="px-4 py-3 text-left text-xs font-semibold text-yellow-600 uppercase">Type</th>
                                        <th class="px-4 py-3 text-left text-xs font-semibold text-yellow-600 uppercase">Value</th>
                                        <th class="px-4 py-3 text-left text-xs font-semibold text-yellow-600 uppercase">Status</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr><td class="px-4 py-4 text-white">2022 Ford F-150</td><td class="px-4 py-4 text-gray-400">Light-Duty Truck</td><td class="px-4 py-4 text-white">$45,000</td><td class="px-4 py-4 text-green-400">Active</td></tr>
                                    <tr><td class="px-4 py-4 text-white">2021 Ford Transit</td><td class="px-4 py-4 text-gray-400">Cargo Van</td><td class="px-4 py-4 text-white">$38,000</td><td class="px-4 py-4 text-green-400">Active</td></tr>
                                    <tr><td class="px-4 py-4 text-white">2023 Chevrolet Silverado</td><td class="px-4 py-4 text-gray-400">Heavy-Duty Truck</td><td class="px-4 py-4 text-white">$52,000</td><td class="px-4 py-4 text-green-400">Active</td></tr>
                                </tbody>
                            </table>
                        </div>
                    `;
                } else if (state.currentSubPage.business === 'business-property') {
                    mainContent = subNav + `
                        <h2 class="text-3xl font-bold text-yellow-600 mb-6">Commercial Property</h2>
                        <div class="bg-black rounded-xl border border-yellow-600/20 p-6">
                            <h3 class="text-xl font-bold text-white mb-4">123 Industrial Way, Atlanta, GA</h3>
                            <div class="grid grid-cols-2 gap-4">
                                <div class="flex justify-between py-3 border-b border-yellow-600/10">
                                    <span class="text-gray-400">Property Value</span>
                                    <span class="text-white font-semibold">$2,350,000</span>
                                </div>
                                <div class="flex justify-between py-3 border-b border-yellow-600/10">
                                    <span class="text-gray-400">Mortgage Balance</span>
                                    <span class="text-white font-semibold">$1,680,000</span>
                                </div>
                                <div class="flex justify-between py-3">
                                    <span class="text-gray-400">Property Equity</span>
                                    <span class="text-green-400 font-semibold">$670,000</span>
                                </div>
                                <div class="flex justify-between py-3">
                                    <span class="text-gray-400">Rental Income</span>
                                    <span class="text-green-400 font-semibold">$12,500/mo</span>
                                </div>
                            </div>
                        </div>
                    `;
                } else if (state.currentSubPage.business === 'business-insurance') {
                    mainContent = subNav + `
                        <h2 class="text-3xl font-bold text-yellow-600 mb-6">Business Insurance</h2>
                        <div class="bg-black rounded-xl border border-yellow-600/20 p-6">
                            <table class="w-full">
                                <thead class="bg-yellow-600/10">
                                    <tr>
                                        <th class="px-4 py-3 text-left text-xs font-semibold text-yellow-600 uppercase">Policy Type</th>
                                        <th class="px-4 py-3 text-left text-xs font-semibold text-yellow-600 uppercase">Carrier</th>
                                        <th class="px-4 py-3 text-left text-xs font-semibold text-yellow-600 uppercase">Premium</th>
                                        <th class="px-4 py-3 text-left text-xs font-semibold text-yellow-600 uppercase">Expires</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr><td class="px-4 py-4 text-white">General Liability</td><td class="px-4 py-4 text-gray-400">Hartford</td><td class="px-4 py-4 text-white">$5,200/yr</td><td class="px-4 py-4 text-gray-400">06/01/2026</td></tr>
                                    <tr><td class="px-4 py-4 text-white">Workers' Comp</td><td class="px-4 py-4 text-gray-400">Travelers</td><td class="px-4 py-4 text-white">$12,500/yr</td><td class="px-4 py-4 text-gray-400">03/15/2026</td></tr>
                                    <tr><td class="px-4 py-4 text-white">Commercial Auto</td><td class="px-4 py-4 text-gray-400">Progressive</td><td class="px-4 py-4 text-white">$8,800/yr</td><td class="px-4 py-4 text-gray-400">07/01/2026</td></tr>
                                </tbody>
                            </table>
                        </div>
                    `;
                }
            }
            
            app.innerHTML = `
                <!-- Header -->
                <header class="bg-white border-b sticky top-0 z-40">
                    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
                        <div class="flex items-center justify-between h-16">
                            <div class="flex items-center space-x-3">
                                <div class="w-10 h-10 bg-gradient-to-r from-yellow-600 to-yellow-700 rounded-lg flex items-center justify-center text-black">
                                    ${icons.shield}
                                </div>
                                <span class="font-bold text-2xl text-gray-900">Truevestments</span>
                            </div>
                            
                            <nav class="hidden lg:flex space-x-2">
                                ${[
                                    { id: 'home', label: 'Home', icon: 'home' },
                                    { id: 'personal', label: 'Personal', icon: 'user' },
                                    { id: 'business', label: 'Business', icon: 'building' },
                                    { id: 'investments', label: 'Investments', icon: 'trending' }
                                ].map(nav => `
                                    <button onclick="setPage('${nav.id}')" class="px-4 py-2 rounded-lg font-semibold text-sm flex items-center space-x-2 relative ${state.currentPage === nav.id ? 'text-gray-900' : 'text-gray-600 hover:bg-gray-100'}">
                                        ${icons[nav.icon]}
                                        <span>${nav.label}</span>
                                        ${state.currentPage === nav.id ? '<div class="absolute bottom-0 left-4 right-4 h-0.5 bg-yellow-600"></div>' : ''}
                                    </button>
                                `).join('')}
                            </nav>
                            
                            <div class="flex space-x-2">
                                <button onclick="toggleChat()" class="px-4 py-2 ${state.chatOpen ? 'bg-green-600 text-white' : 'bg-yellow-600 text-black hover:bg-yellow-700'} rounded-lg font-semibold text-sm flex items-center space-x-2">
                                    ${icons.chat}
                                    <span>AI Chat</span>
                                </button>
                                <button onclick="toggleVoice()" class="px-4 py-2 bg-yellow-600 text-black rounded-lg font-semibold text-sm hover:bg-yellow-700 flex items-center space-x-2">
                                    ${icons.mic}
                                    <span>Voice</span>
                                </button>
                            </div>
                        </div>
                    </div>
                </header>

                <!-- Main Content -->
                <main class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8">
                    <div class="bg-gray-900 rounded-2xl border border-yellow-600/20 p-8">
                        ${mainContent}
                    </div>
                </main>

                <!-- Chat Box -->
                ${state.chatOpen ? `
                    <div class="fixed bottom-6 right-6 w-96 h-[600px] bg-gray-900 border border-yellow-600/20 rounded-2xl shadow-2xl flex flex-col z-50 animate-slideUp">
                        <div class="bg-black border-b border-yellow-600/20 rounded-t-2xl px-4 py-3 flex justify-between items-center">
                            <span class="font-semibold text-yellow-600">ðŸ¤– AI Assistant</span>
                            <button onclick="toggleChat()" class="p-1 rounded-lg hover:bg-yellow-600/20 text-gray-400">${icons.x}</button>
                        </div>
                        <div id="chatBody" class="flex-1 overflow-y-auto p-4 space-y-3">
                            ${state.chatMessages.map(msg => `
                                <div class="p-3 rounded-xl text-sm ${msg.isUser ? 'bg-yellow-600 text-black ml-auto' : 'bg-yellow-600/10 border-l-4 border-yellow-600 text-white'} max-w-[85%]">
                                    ${!msg.isUser ? '<div class="font-semibold text-yellow-600 mb-1">ðŸ¤– AI:</div>' : ''}
                                    <div class="whitespace-pre-wrap">${msg.message}</div>
                                </div>
                            `).join('')}
                        </div>
                        <div class="border-t border-yellow-600/20 p-3 flex gap-2">
                            <input id="chatInput" onkeypress="if(event.key==='Enter') sendChatMessage()" placeholder="Ask about finances..." class="flex-1 px-3 py-2 bg-black border border-yellow-600/20 rounded-lg text-white placeholder-gray-500 text-sm" />
                            <button onclick="sendChatMessage()" class="px-4 py-2 bg-yellow-600 text-black rounded-lg font-semibold hover:bg-yellow-700 text-sm">Send</button>
                        </div>
                    </div>
                ` : ''}

                <!-- Voice Modal -->
                ${state.voiceOpen ? `
                    <div class="fixed inset-0 bg-black/80 backdrop-blur-sm z-50 flex items-center justify-center p-4">
                        <button onclick="toggleVoice()" class="absolute top-8 right-8 text-white hover:text-yellow-600">${icons.x}</button>
                        <div class="text-center">
                            <div class="w-32 h-32 mx-auto mb-6 text-yellow-600 animate-pulse">${icons.mic}</div>
                            <h2 class="text-3xl font-bold text-yellow-600 mb-4">Voice AI Ready</h2>
                            <p class="text-xl text-gray-400">Click microphone to speak</p>
                        </div>
                    </div>
                ` : ''}
            `;
        }

        // Global Functions
        window.setPage = (page) => { state.currentPage = page; render(); };
        window.setSubPage = (parent, sub) => { state.currentSubPage[parent] = sub; render(); };
        window.toggleChat = () => { state.chatOpen = !state.chatOpen; render(); setTimeout(() => document.getElementById('chatInput')?.focus(), 100); };
        window.toggleVoice = () => { state.voiceOpen = !state.voiceOpen; render(); };
        window.sendChatMessage = sendChatMessage;
        window.scanVIN = scanVIN;

        // Initialize
        fetchCryptoPrices();
        fetchStockPrices();
        setInterval(fetchCryptoPrices, 60000);
        setInterval(fetchStockPrices, 30000);
        render();
    </script>
</body>
</html>
