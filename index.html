<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Truevestments - AI-Powered Life Infrastructure Management</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet">
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: 'Inter', sans-serif; background: #000; color: #fff; }
        .animate-slideUp { animation: slideUp 0.3s ease; }
        @keyframes slideUp { from { opacity: 0; transform: translateY(20px); } to { opacity: 1; transform: translateY(0); } }
    </style>
</head>
<body>
    <div id="app"></div>

    <script>
        let state = {
            currentPage: 'home',
            currentSubPage: { personal: 'personal-auto', business: 'business-fleet' },
            sidebarOpen: false,
            chatOpen: false,
            voiceOpen: false,
            chatMessages: [{ isUser: false, message: "Hi! I'm your AI assistant. Ask about portfolio, insurance, refinancing, or net worth." }],
            cryptoData: {},
            stockData: {},
            vinInput: '',
            vinResults: null,
            businessVinInput: '',
            businessVinResults: null,
            homeSearch: '',
            homePriceFilter: '',
            vehicleSearch: '',
            vehiclePriceFilter: '',
            vehicleTypeFilter: '',
            commercialPropertySearch: '',
            commercialPropertyPriceFilter: '',
            commercialVehicleSearch: '',
            commercialVehiclePriceFilter: '',
            commercialVehicleTypeFilter: ''
        };

        const CRYPTO_HOLDINGS = { bitcoin: 0.75, ethereum: 12 };
        const STOCK_HOLDINGS = {
            AAPL: { shares: 150, costBasis: 162.00 },
            GOOGL: { shares: 50, costBasis: 102.40 },
            TSLA: { shares: 100, costBasis: 244.00 }
        };

        const AI_RESPONSES = {
            'portfolio': 'Based on your holdings: $28,575 stocks, ~$32K crypto, $228K retirement. Total: ~$288K. Tech-heavy at 68%!',
            'insurance': 'Found $1,280 annual savings! Auto: -$420/yr, Home: -$380/yr.',
            'refinance': 'Your $220K equity qualifies for 3.75%! Save $288/month.',
            'vehicle': 'Your CR-V has $11,300 equity. Trade for Accord Hybrid: $410/mo.',
            'net worth': 'Total: $796,325 (Home $220K, Retirement $228K, Business $277K)',
            'default': 'I can help with: portfolio, insurance, refinancing, vehicles, or business.'
        };

        const mockHomes = [
            { id: 1, address: "456 Maple St, Atlanta 30309", price: 485000, beds: 3, baths: 2.5, sqft: 2150, yearBuilt: 2018, description: "Modern townhome", source: "Zillow", daysOnMarket: 12 },
            { id: 2, address: "789 Peachtree Rd, Atlanta 30326", price: 695000, beds: 4, baths: 3, sqft: 2800, yearBuilt: 2020, description: "Luxury home", source: "Redfin", daysOnMarket: 5 }
        ];

        const mockVehicles = [
            { id: 1, year: 2022, make: "Honda", model: "CR-V", trim: "EX-L", price: 32500, mileage: 15420, type: "suv", description: "Excellent condition", source: "AutoTrader", mpg: "28/34", carfaxScore: 4.8 },
            { id: 2, year: 2023, make: "Toyota", model: "Camry", trim: "XLE", price: 28900, mileage: 8950, type: "sedan", description: "Like new", source: "KBB", mpg: "32/41", carfaxScore: 4.9 }
        ];

        const mockCommercialProperties = [
            { id: 1, address: "1500 Commerce Dr, Atlanta 30318", price: 1850000, sqft: 8500, yearBuilt: 2015, description: "Warehouse with office space", source: "LoopNet", daysOnMarket: 18, type: "Warehouse" },
            { id: 2, address: "2200 Industrial Blvd, Atlanta 30344", price: 2450000, sqft: 12000, yearBuilt: 2019, description: "Modern industrial facility", source: "Commercial MLS", daysOnMarket: 25, type: "Industrial" }
        ];

        const mockCommercialVehicles = [
            { id: 1, year: 2023, make: "Ford", model: "F-450", trim: "XLT", price: 58500, mileage: 12500, type: "truck", description: "Heavy-duty work truck", source: "Commercial Truck Trader", mpg: "14/18", condition: "Excellent" },
            { id: 2, year: 2022, make: "Mercedes", model: "Sprinter", trim: "2500", price: 48900, mileage: 22000, type: "van", description: "Cargo van with shelving", source: "Commercial Auto", mpg: "18/24", condition: "Very Good" }
        ];

        const personalInsuranceQuotes = [
            { carrier: "Current (Allstate)", type: "Auto", premium: 1680, coverage: "Full Coverage", deductible: 500, status: "current" },
            { carrier: "Geico", type: "Auto", premium: 1260, coverage: "Full Coverage", deductible: 500, status: "quote", savings: 420 },
            { carrier: "Progressive", type: "Auto", premium: 1340, coverage: "Full Coverage", deductible: 500, status: "quote", savings: 340 },
            { carrier: "Current (State Farm)", type: "Home", premium: 1840, coverage: "$535K Dwelling", deductible: 2500, status: "current" },
            { carrier: "Liberty Mutual", type: "Home", premium: 1460, coverage: "$535K Dwelling", deductible: 2500, status: "quote", savings: 380 },
            { carrier: "Travelers", type: "Home", premium: 1520, coverage: "$535K Dwelling", deductible: 2500, status: "quote", savings: 320 },
            { carrier: "USAA", type: "Umbrella", premium: 240, coverage: "$1M Liability", deductible: 0, status: "quote", savings: 0 }
        ];

        const businessInsuranceQuotes = [
            { carrier: "Current (Hartford)", type: "General Liability", premium: 5200, coverage: "$2M Aggregate", deductible: 1000, status: "current" },
            { carrier: "Chubb", type: "General Liability", premium: 4680, coverage: "$2M Aggregate", deductible: 1000, status: "quote", savings: 520 },
            { carrier: "Liberty Mutual", type: "General Liability", premium: 4850, coverage: "$2M Aggregate", deductible: 1000, status: "quote", savings: 350 },
            { carrier: "Current (Travelers)", type: "Workers' Comp", premium: 12500, coverage: "24 Employees", deductible: 0, status: "current" },
            { carrier: "The Hartford", type: "Workers' Comp", premium: 11800, coverage: "24 Employees", deductible: 0, status: "quote", savings: 700 },
            { carrier: "AmTrust", type: "Workers' Comp", premium: 12100, coverage: "24 Employees", deductible: 0, status: "quote", savings: 400 },
            { carrier: "Current (Progressive)", type: "Commercial Auto", premium: 8800, coverage: "3 Vehicles", deductible: 1000, status: "current" },
            { carrier: "Nationwide", type: "Commercial Auto", premium: 7950, coverage: "3 Vehicles", deductible: 1000, status: "quote", savings: 850 },
            { carrier: "Geico Commercial", type: "Commercial Auto", premium: 8200, coverage: "3 Vehicles", deductible: 1000, status: "quote", savings: 600 }
        ];

        async function fetchCryptoPrices() {
            try {
                const response = await fetch('https://api.coingecko.com/api/v3/simple/price?ids=bitcoin,ethereum,solana,litecoin,ripple&vs_currencies=usd&include_24hr_change=true&include_market_cap=true');
                if (!response.ok) throw new Error('API failed');
                state.cryptoData = await response.json();
            } catch (error) {
                state.cryptoData = {
                    bitcoin: { usd: 108000, usd_24h_change: 2.5, usd_market_cap: 2.1e12 },
                    ethereum: { usd: 4200, usd_24h_change: 3.2, usd_market_cap: 5e11 },
                    solana: { usd: 250, usd_24h_change: 5.1, usd_market_cap: 1.2e11 },
                    litecoin: { usd: 110, usd_24h_change: 1.8, usd_market_cap: 8.2e9 },
                    ripple: { usd: 3.20, usd_24h_change: 4.2, usd_market_cap: 1.85e11 }
                };
            }
        }

        function fetchStockPrices() {
            const now = new Date();
            const isOpen = now.getDay() !== 0 && now.getDay() !== 6 && now.getHours() >= 9 && now.getHours() < 16;
            state.stockData = {
                AAPL: { price: 190.50 + Math.random() * 10, change: (Math.random() - 0.5) * 6 },
                GOOGL: { price: 141.20 + Math.random() * 8, change: (Math.random() - 0.5) * 5 },
                TSLA: { price: 183.45 + Math.random() * 15, change: (Math.random() - 0.5) * 8 }
            };
            state.marketStatus = isOpen ? 'â— Open' : 'â— Closed';
        }

        async function scanVIN(isPersonal = true) {
            const vinField = isPersonal ? 'vinInput' : 'businessVinInput';
            const resultsField = isPersonal ? 'vinResults' : 'businessVinResults';
            const vin = state[vinField].toUpperCase().trim();
            if (vin.length !== 17 || !/^[A-HJ-NPR-Z0-9]{17}$/.test(vin)) {
                state[resultsField] = { error: 'Invalid VIN' };
                render();
                return;
            }
            state[resultsField] = { loading: true };
            render();
            try {
                const res = await fetch(`https://vpic.nhtsa.dot.gov/api/vehicles/decodevin/${vin}?format=json`);
                const data = await res.json();
                if (data.Results?.length) {
                    const get = (v) => data.Results.find(r => r.Variable === v)?.Value || 'N/A';
                    state[resultsField] = {
                        success: true,
                        make: get('Make'),
                        model: get('Model'),
                        year: get('Model Year'),
                        bodyType: get('Body Class')
                    };
                } else {
                    state[resultsField] = { error: 'VIN not found' };
                }
            } catch {
                state[resultsField] = { error: 'API failed' };
            }
            render();
        }

        function getAIResponse(msg) {
            const m = msg.toLowerCase();
            for (const [key, res] of Object.entries(AI_RESPONSES)) {
                if (m.includes(key)) return res;
            }
            return AI_RESPONSES.default;
        }

        function sendChatMessage() {
            const input = document.getElementById('chatInput');
            const message = input.value.trim();
            if (!message) return;
            state.chatMessages.push({ isUser: true, message });
            input.value = '';
            render();
            setTimeout(() => {
                state.chatMessages.push({ isUser: false, message: getAIResponse(message) });
                render();
                document.getElementById('chatBody').scrollTop = 999999;
            }, 1000);
        }

        function getFilteredHomes() {
            let filtered = mockHomes;
            if (state.homeSearch) filtered = filtered.filter(h => h.address.toLowerCase().includes(state.homeSearch.toLowerCase()));
            if (state.homePriceFilter) {
                const [min, max] = state.homePriceFilter.split('-').map(Number);
                filtered = filtered.filter(h => h.price >= min && h.price <= max);
            }
            return filtered;
        }

        function getFilteredVehicles() {
            let filtered = mockVehicles;
            if (state.vehicleSearch) filtered = filtered.filter(v => `${v.year} ${v.make} ${v.model}`.toLowerCase().includes(state.vehicleSearch.toLowerCase()));
            if (state.vehiclePriceFilter) {
                const [min, max] = state.vehiclePriceFilter.split('-').map(Number);
                filtered = filtered.filter(v => v.price >= min && v.price <= max);
            }
            if (state.vehicleTypeFilter) filtered = filtered.filter(v => v.type === state.vehicleTypeFilter);
            return filtered;
        }

        function getFilteredCommercialProperties() {
            let filtered = mockCommercialProperties;
            if (state.commercialPropertySearch) filtered = filtered.filter(p => p.address.toLowerCase().includes(state.commercialPropertySearch.toLowerCase()));
            if (state.commercialPropertyPriceFilter) {
                const [min, max] = state.commercialPropertyPriceFilter.split('-').map(Number);
                filtered = filtered.filter(p => p.price >= min && p.price <= max);
            }
            return filtered;
        }

        function getFilteredCommercialVehicles() {
            let filtered = mockCommercialVehicles;
            if (state.commercialVehicleSearch) filtered = filtered.filter(v => `${v.year} ${v.make} ${v.model}`.toLowerCase().includes(state.commercialVehicleSearch.toLowerCase()));
            if (state.commercialVehiclePriceFilter) {
                const [min, max] = state.commercialVehiclePriceFilter.split('-').map(Number);
                filtered = filtered.filter(v => v.price >= min && v.price <= max);
            }
            return filtered;
        }

        const icons = {
            shield: '<svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m5.618-4.016A11.955 11.955 0 0112 2.944a11.955 11.955 0 01-8.618 3.04A12.02 12.02 0 003 9c0 5.591 3.824 10.29 9 11.622 5.176-1.332 9-6.03 9-11.622 0-1.042-.133-2.052-.382-3.016z"/></svg>',
            menu: '<svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"/></svg>',
            home: '<svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 12l2-2m0 0l7-7 7 7M5 10v10a1 1 0 001 1h3m10-11l2 2m-2-2v10a1 1 0 01-1 1h-3m-6 0a1 1 0 001-1v-4a1 1 0 011-1h2a1 1 0 011 1v4a1 1 0 001 1m-6 0h6"/></svg>',
            user: '<svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"/></svg>',
            building: '<svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16m14 0h2m-2 0h-5m-9 0H3m2 0h5M9 7h1m-1 4h1m4-4h1m-1 4h1m-5 10v-5a1 1 0 011-1h2a1 1 0 011 1v5m-4 0h4"/></svg>',
            trending: '<svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 7h8m0 0v8m0-8l-8 8-4-4-6 6"/></svg>',
            car: '<svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 17a2 2 0 11-4 0 2 2 0 014 0zM19 17a2 2 0 11-4 0 2 2 0 014 0z"/></svg>',
            chat: '<svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z"/></svg>',
            mic: '<svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 11a7 7 0 01-7 7m0 0a7 7 0 01-7-7m7 7v4m0 0H8m4 0h4m-4-8a3 3 0 01-3-3V5a3 3 0 116 0v6a3 3 0 01-3 3z"/></svg>',
            x: '<svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"/></svg>',
            sparkles: '<svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 3v4M3 5h4M6 17v4m-2-2h4m5-16l2.286 6.857L21 12l-5.714 2.143L13 21l-2.286-6.857L5 12l5.714-2.143L13 3z"/></svg>'
        };

        function render() {
            const app = document.getElementById('app');
            let mainContent = '';

            // HOME
            if (state.currentPage === 'home') {
                mainContent = `
                    <div class="text-center py-12">
                        <h1 class="text-4xl sm:text-5xl font-bold text-yellow-600 mb-4">AI-Powered Life Infrastructure</h1>
                        <p class="text-lg sm:text-xl text-gray-400 max-w-3xl mx-auto mb-8">
                            The first platform that organizes, monitors, and optimizes your complete financial ecosystem
                        </p>
                        <button onclick="setPage('personal')" class="bg-yellow-600 text-black px-8 py-3 rounded-lg font-bold hover:bg-yellow-700">
                            Get Started
                        </button>
                    </div>
                    <div class="bg-gradient-to-r from-yellow-600/5 border border-yellow-600/20 rounded-xl p-6 mt-8">
                        <h3 class="text-xl font-bold text-white mb-4 flex items-center">
                            ${icons.sparkles}
                            <span class="ml-2">AI Insights & Recommendations</span>
                        </h3>
                        <div class="space-y-3">
                            <div class="bg-black/50 border-l-4 border-yellow-600 rounded-lg p-4">
                                <strong class="text-yellow-600">Critical Alert:</strong> GL policy expires in 15 days. Found 20% cost reduction.
                            </div>
                            <div class="bg-black/50 border-l-4 border-yellow-600 rounded-lg p-4">
                                <strong class="text-yellow-600">Vehicle:</strong> Tesla Model Y could save $2,400/yr fuel + 15% insurance.
                            </div>
                            <div class="bg-black/50 border-l-4 border-yellow-600 rounded-lg p-4">
                                <strong class="text-yellow-600">Portfolio:</strong> Overweight tech. Reallocate 15% to value stocks.
                            </div>
                        </div>
                    </div>
                `;
            }

            // INVESTMENTS
            else if (state.currentPage === 'investments') {
                const btcValue = CRYPTO_HOLDINGS.bitcoin * (state.cryptoData.bitcoin?.usd || 0);
                const ethValue = CRYPTO_HOLDINGS.ethereum * (state.cryptoData.ethereum?.usd || 0);
                
                mainContent = `
                    <h2 class="text-2xl sm:text-3xl font-bold text-yellow-600 mb-6">Investment Portfolio <span class="text-sm text-gray-400">${state.marketStatus || ''}</span></h2>
                    
                    <div class="bg-black rounded-xl border border-yellow-600/20 p-4 sm:p-6 mb-6">
                        <h3 class="text-lg sm:text-xl font-bold text-white mb-4">Stock Portfolio</h3>
                        <div class="overflow-x-auto">
                            <table class="w-full text-sm">
                                <thead class="bg-yellow-600/10">
                                    <tr>
                                        <th class="px-3 py-2 text-left text-xs text-yellow-600">Symbol</th>
                                        <th class="px-3 py-2 text-left text-xs text-yellow-600">Shares</th>
                                        <th class="px-3 py-2 text-left text-xs text-yellow-600">Price</th>
                                        <th class="px-3 py-2 text-left text-xs text-yellow-600">Value</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    ${Object.keys(STOCK_HOLDINGS).map(symbol => {
                                        const holding = STOCK_HOLDINGS[symbol];
                                        const stock = state.stockData[symbol] || { price: 0, change: 0 };
                                        const value = holding.shares * stock.price;
                                        return `
                                            <tr class="border-t border-yellow-600/10">
                                                <td class="px-3 py-3 font-semibold text-white">${symbol}</td>
                                                <td class="px-3 py-3 text-gray-400">${holding.shares}</td>
                                                <td class="px-3 py-3 text-white">$${stock.price.toFixed(2)}</td>
                                                <td class="px-3 py-3 text-white">$${value.toFixed(2)}</td>
                                            </tr>
                                        `;
                                    }).join('')}
                                </tbody>
                            </table>
                        </div>
                    </div>
                    
                    <div class="bg-black rounded-xl border border-yellow-600/20 p-4 sm:p-6 mb-6">
                        <h3 class="text-lg sm:text-xl font-bold text-white mb-4">Retirement Accounts</h3>
                        <div class="space-y-3">
                            <div class="flex justify-between py-2">
                                <span class="text-gray-400">401(k)</span>
                                <span class="text-white font-semibold">$185,250</span>
                            </div>
                            <div class="flex justify-between py-2">
                                <span class="text-gray-400">ROTH IRA</span>
                                <span class="text-white font-semibold">$42,800</span>
                            </div>
                            <div class="flex justify-between py-2 pt-2 border-t border-yellow-600/20">
                                <span class="text-gray-400">Total</span>
                                <span class="text-green-400 font-bold">$228,050</span>
                            </div>
                        </div>
                    </div>
                    
                    <div class="bg-black rounded-xl border border-yellow-600/20 p-4 sm:p-6">
                        <h3 class="text-lg sm:text-xl font-bold text-white mb-4">Digital Assets</h3>
                        <div class="space-y-3">
                            <div class="flex justify-between py-2">
                                <span class="text-gray-400">Bitcoin (${CRYPTO_HOLDINGS.bitcoin} BTC)</span>
                                <span class="text-green-400 font-semibold">$${btcValue.toFixed(2)}</span>
                            </div>
                            <div class="flex justify-between py-2">
                                <span class="text-gray-400">Ethereum (${CRYPTO_HOLDINGS.ethereum} ETH)</span>
                                <span class="text-green-400 font-semibold">$${ethValue.toFixed(2)}</span>
                            </div>
                            <div class="flex justify-between py-2 pt-2 border-t border-yellow-600/20">
                                <span class="text-gray-400">Total Crypto</span>
                                <span class="text-green-400 font-bold">$${(btcValue + ethValue).toFixed(2)}</span>
                            </div>
                        </div>
                    </div>
                `;
            }

            // PERSONAL
            else if (state.currentPage === 'personal') {
                const subNav = `
                    <div class="flex flex-wrap gap-2 border-b border-yellow-600/20 pb-4 mb-6">
                        <button onclick="setSubPage('personal', 'personal-auto')" class="px-3 py-2 rounded-lg text-sm ${state.currentSubPage.personal === 'personal-auto' ? 'text-yellow-600 bg-yellow-600/10 font-bold' : 'text-gray-400'}">
                            Auto
                        </button>
                        <button onclick="setSubPage('personal', 'personal-home')" class="px-3 py-2 rounded-lg text-sm ${state.currentSubPage.personal === 'personal-home' ? 'text-yellow-600 bg-yellow-600/10 font-bold' : 'text-gray-400'}">
                            Home
                        </button>
                        <button onclick="setSubPage('personal', 'personal-insurance')" class="px-3 py-2 rounded-lg text-sm ${state.currentSubPage.personal === 'personal-insurance' ? 'text-yellow-600 bg-yellow-600/10 font-bold' : 'text-gray-400'}">
                            Insurance
                        </button>
                    </div>
                `;
                
                if (state.currentSubPage.personal === 'personal-auto') {
                    mainContent = subNav + `
                        <h2 class="text-2xl font-bold text-yellow-600 mb-4">Personal Auto</h2>
                        <div class="bg-black rounded-xl border border-yellow-600/20 p-4 mb-4">
                            <h3 class="text-lg font-bold text-white mb-3">2022 Honda CR-V</h3>
                            <div class="space-y-2 text-sm">
                                <div class="flex justify-between"><span class="text-gray-400">Value:</span><span class="text-green-400">$29,500</span></div>
                                <div class="flex justify-between"><span class="text-gray-400">Loan:</span><span class="text-yellow-400">$18,200</span></div>
                                <div class="flex justify-between"><span class="text-gray-400">Equity:</span><span class="text-green-400 font-bold">$11,300</span></div>
                            </div>
                        </div>
                        <div class="bg-black rounded-xl border border-yellow-600/20 p-4">
                            <h3 class="text-lg font-bold text-white mb-3">VIN Decoder</h3>
                            <div class="flex gap-2 mb-3">
                                <input type="text" value="${state.vinInput}" oninput="state.vinInput=this.value" placeholder="Enter VIN..." class="flex-1 px-3 py-2 bg-gray-900 border border-yellow-600/20 rounded text-white text-sm">
                                <button onclick="scanVIN(true)" class="px-4 py-2 bg-yellow-600 text-black rounded font-bold text-sm">Scan</button>
                            </div>
                            ${state.vinResults ? `
                                <div class="bg-gray-900 rounded p-3 text-sm">
                                    ${state.vinResults.error ? `<div class="text-red-400">${state.vinResults.error}</div>` : ''}
                                    ${state.vinResults.loading ? `<div class="text-yellow-600">Loading...</div>` : ''}
                                    ${state.vinResults.success ? `
                                        <div class="text-yellow-600 font-bold mb-2">âœ“ Decoded</div>
                                        <div class="space-y-1 text-gray-300">
                                            <div>Make: ${state.vinResults.make}</div>
                                            <div>Model: ${state.vinResults.model}</div>
                                            <div>Year: ${state.vinResults.year}</div>
                                        </div>
                                    ` : ''}
                                </div>
                            ` : ''}
                        </div>
                    `;
                } else if (state.currentSubPage.personal === 'personal-home') {
                    mainContent = subNav + `
                        <h2 class="text-2xl font-bold text-yellow-600 mb-4">Personal Home</h2>
                        <div class="bg-black rounded-xl border border-yellow-600/20 p-4">
                            <h3 class="text-lg font-bold text-white mb-3">123 Peachtree Lane, Atlanta</h3>
                            <div class="space-y-2 text-sm">
                                <div class="flex justify-between"><span class="text-gray-400">Value:</span><span class="text-white">$535,000</span></div>
                                <div class="flex justify-between"><span class="text-gray-400">Mortgage:</span><span class="text-white">$315,000</span></div>
                                <div class="flex justify-between"><span class="text-gray-400">Equity:</span><span class="text-green-400 font-bold">$220,000</span></div>
                                <div class="flex justify-between"><span class="text-gray-400">Rate:</span><span class="text-yellow-400">4.15%</span></div>
                            </div>
                        </div>
                    `;
                } else if (state.currentSubPage.personal === 'personal-insurance') {
                    const totalCurrent = personalInsuranceQuotes.filter(q => q.status === 'current').reduce((sum, q) => sum + q.premium, 0);
                    const totalSavings = personalInsuranceQuotes.filter(q => q.savings).reduce((sum, q) => sum + (q.savings || 0), 0);
                    
                    mainContent = subNav + `
                        <h2 class="text-2xl font-bold text-yellow-600 mb-4">Personal Insurance</h2>
                        <div class="bg-black rounded-xl border border-yellow-600/20 p-4 mb-4">
                            <div class="space-y-2 text-sm">
                                <div class="flex justify-between"><span class="text-gray-400">Current Premium:</span><span class="text-white">$${totalCurrent}/yr</span></div>
                                <div class="flex justify-between"><span class="text-gray-400">Potential Savings:</span><span class="text-green-400 font-bold">$${totalSavings}/yr</span></div>
                            </div>
                        </div>
                        <div class="space-y-4">
                            ${['Auto', 'Home'].map(type => {
                                const quotes = personalInsuranceQuotes.filter(q => q.type === type);
                                const current = quotes.find(q => q.status === 'current');
                                const alternatives = quotes.filter(q => q.status === 'quote' && q.savings);
                                
                                return `
                                    <div class="bg-black rounded-xl border border-yellow-600/20 p-4">
                                        <h3 class="text-lg font-bold text-yellow-600 mb-3">${type} Insurance</h3>
                                        ${current ? `
                                            <div class="bg-gray-900 border-l-4 border-blue-500 rounded p-3 mb-2 text-sm">
                                                <div class="flex justify-between mb-1">
                                                    <span class="text-blue-400 font-bold">${current.carrier}</span>
                                                    <span class="text-white">$${current.premium}/yr</span>
                                                </div>
                                                <div class="text-xs text-gray-400">${current.coverage}</div>
                                            </div>
                                        ` : ''}
                                        ${alternatives.map(q => `
                                            <div class="bg-gray-900/50 border-l-4 border-green-500 rounded p-3 mb-2 text-sm">
                                                <div class="flex justify-between mb-1">
                                                    <div>
                                                        <span class="text-green-400 font-bold">${q.carrier}</span>
                                                        <span class="ml-2 text-xs bg-green-600 text-white px-2 py-0.5 rounded">SAVE $${q.savings}</span>
                                                    </div>
                                                    <span class="text-green-400 font-bold">$${q.premium}/yr</span>
                                                </div>
                                                <div class="text-xs text-gray-400">${q.coverage}</div>
                                            </div>
                                        `).join('')}
                                    </div>
                                `;
                            }).join('')}
                        </div>
                    `;
                }
            }

            // BUSINESS
            else if (state.currentPage === 'business') {
                const subNav = `
                    <div class="flex flex-wrap gap-2 border-b border-yellow-600/20 pb-4 mb-6">
                        <button onclick="setSubPage('business', 'business-dashboard')" class="px-3 py-2 rounded-lg text-sm ${state.currentSubPage.business === 'business-dashboard' ? 'text-yellow-600 bg-yellow-600/10 font-bold' : 'text-gray-400'}">
                            Dashboard
                        </button>
                        <button onclick="setSubPage('business', 'business-fleet')" class="px-3 py-2 rounded-lg text-sm ${state.currentSubPage.business === 'business-fleet' ? 'text-yellow-600 bg-yellow-600/10 font-bold' : 'text-gray-400'}">
                            Fleet
                        </button>
                        <button onclick="setSubPage('business', 'business-property')" class="px-3 py-2 rounded-lg text-sm ${state.currentSubPage.business === 'business-property' ? 'text-yellow-600 bg-yellow-600/10 font-bold' : 'text-gray-400'}">
                            Property
                        </button>
                        <button onclick="setSubPage('business', 'business-insurance')" class="px-3 py-2 rounded-lg text-sm ${state.currentSubPage.business === 'business-insurance' ? 'text-yellow-600 bg-yellow-600/10 font-bold' : 'text-gray-400'}">
                            Insurance
                        </button>
                    </div>
                `;
                
                if (state.currentSubPage.business === 'business-dashboard') {
                    mainContent = subNav + `
                        <h2 class="text-2xl font-bold text-yellow-600 mb-4">Business Dashboard</h2>
                        <div class="bg-black rounded-xl border border-yellow-600/20 p-4">
                            <div class="grid grid-cols-2 gap-4 text-sm">
                                <div class="flex justify-between py-2"><span class="text-gray-400">Revenue:</span><span class="text-green-400 font-bold">$1.2M</span></div>
                                <div class="flex justify-between py-2"><span class="text-gray-400">Profit:</span><span class="text-green-400 font-bold">$485K</span></div>
                                <div class="flex justify-between py-2"><span class="text-gray-400">Employees:</span><span class="text-white">24</span></div>
                                <div class="flex justify-between py-2"><span class="text-gray-400">Growth:</span><span class="text-green-400">+15.2%</span></div>
                            </div>
                        </div>
                    `;
                } else if (state.currentSubPage.business === 'business-fleet') {
                    mainContent = subNav + `
                        <h2 class="text-2xl font-bold text-yellow-600 mb-4">Commercial Fleet</h2>
                        <div class="bg-black rounded-xl border border-yellow-600/20 p-4 mb-4">
                            <div class="space-y-2 text-sm">
                                <div class="flex justify-between py-2 border-b border-yellow-600/10">
                                    <span class="text-white">2022 Ford F-150</span>
                                    <span class="text-green-400">$45,000</span>
                                </div>
                                <div class="flex justify-between py-2 border-b border-yellow-600/10">
                                    <span class="text-white">2021 Ford Transit</span>
                                    <span class="text-green-400">$38,000</span>
                                </div>
                                <div class="flex justify-between py-2">
                                    <span class="text-white">2023 Chevy Silverado</span>
                                    <span class="text-green-400">$52,000</span>
                                </div>
                                <div class="flex justify-between py-2 pt-2 border-t border-yellow-600/20">
                                    <span class="text-gray-400">Total Fleet:</span>
                                    <span class="text-green-400 font-bold">$135,000</span>
                                </div>
                            </div>
                        </div>
                        <div class="bg-black rounded-xl border border-yellow-600/20 p-4">
                            <h3 class="text-lg font-bold text-white mb-3">Commercial VIN Decoder</h3>
                            <div class="flex gap-2">
                                <input type="text" value="${state.businessVinInput}" oninput="state.businessVinInput=this.value" placeholder="Enter VIN..." class="flex-1 px-3 py-2 bg-gray-900 border border-yellow-600/20 rounded text-white text-sm">
                                <button onclick="scanVIN(false)" class="px-4 py-2 bg-yellow-600 text-black rounded font-bold text-sm">Scan</button>
                            </div>
                        </div>
                    `;
                } else if (state.currentSubPage.business === 'business-property') {
                    mainContent = subNav + `
                        <h2 class="text-2xl font-bold text-yellow-600 mb-4">Commercial Property</h2>
                        <div class="bg-black rounded-xl border border-yellow-600/20 p-4">
                            <h3 class="text-lg font-bold text-white mb-3">123 Industrial Way, Atlanta</h3>
                            <div class="space-y-2 text-sm">
                                <div class="flex justify-between"><span class="text-gray-400">Value:</span><span class="text-white">$2.35M</span></div>
                                <div class="flex justify-between"><span class="text-gray-400">Mortgage:</span><span class="text-white">$1.68M</span></div>
                                <div class="flex justify-between"><span class="text-gray-400">Equity:</span><span class="text-green-400 font-bold">$670K</span></div>
                                <div class="flex justify-between"><span class="text-gray-400">Rental:</span><span class="text-green-400">$12.5K/mo</span></div>
                            </div>
                        </div>
                    `;
                } else if (state.currentSubPage.business === 'business-insurance') {
                    const totalCurrent = businessInsuranceQuotes.filter(q => q.status === 'current').reduce((sum, q) => sum + q.premium, 0);
                    const totalSavings = businessInsuranceQuotes.filter(q => q.savings).reduce((sum, q) => sum + (q.savings || 0), 0);
                    
                    mainContent = subNav + `
                        <h2 class="text-2xl font-bold text-yellow-600 mb-4">Business Insurance</h2>
                        <div class="bg-black rounded-xl border border-yellow-600/20 p-4 mb-4">
                            <div class="space-y-2 text-sm">
                                <div class="flex justify-between"><span class="text-gray-400">Current Premium:</span><span class="text-white">$${totalCurrent.toLocaleString()}/yr</span></div>
                                <div class="flex justify-between"><span class="text-gray-400">Potential Savings:</span><span class="text-green-400 font-bold">$${totalSavings.toLocaleString()}/yr</span></div>
                            </div>
                        </div>
                        <div class="space-y-4">
                            ${['General Liability', 'Workers\' Comp', 'Commercial Auto'].map(type => {
                                const quotes = businessInsuranceQuotes.filter(q => q.type === type);
                                const current = quotes.find(q => q.status === 'current');
                                const alternatives = quotes.filter(q => q.status === 'quote' && q.savings);
                                
                                return `
                                    <div class="bg-black rounded-xl border border-yellow-600/20 p-4">
                                        <h3 class="text-lg font-bold text-yellow-600 mb-3">${type}</h3>
                                        ${current ? `
                                            <div class="bg-gray-900 border-l-4 border-blue-500 rounded p-3 mb-2 text-sm">
                                                <div class="flex justify-between">
                                                    <span class="text-blue-400 font-bold">${current.carrier}</span>
                                                    <span class="text-white">$${current.premium.toLocaleString()}/yr</span>
                                                </div>
                                            </div>
                                        ` : ''}
                                        ${alternatives.slice(0,2).map(q => `
                                            <div class="bg-gray-900/50 border-l-4 border-green-500 rounded p-3 mb-2 text-sm">
                                                <div class="flex justify-between">
                                                    <div>
                                                        <span class="text-green-400 font-bold">${q.carrier}</span>
                                                        <span class="ml-2 text-xs bg-green-600 text-white px-2 py-0.5 rounded">-$${q.savings}</span>
                                                    </div>
                                                    <span class="text-green-400 font-bold">$${q.premium.toLocaleString()}/yr</span>
                                                </div>
                                            </div>
                                        `).join('')}
                                    </div>
                                `;
                            }).join('')}
                        </div>
                    `;
                }
            }

            app.innerHTML = `
                <header class="bg-white border-b sticky top-0 z-40">
                    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
                        <div class="flex items-center justify-between h-16">
                            <button onclick="toggleSidebar()" class="lg:hidden p-2 rounded-lg hover:bg-gray-100 text-gray-900">
                                ${icons.menu}
                            </button>
                            
                            <div class="flex items-center space-x-3">
                                <div class="w-10 h-10 bg-gradient-to-r from-yellow-600 to-yellow-700 rounded-lg flex items-center justify-center text-black">
                                    ${icons.shield}
                                </div>
                                <span class="hidden sm:block font-bold text-2xl text-gray-900">Truevestments</span>
                            </div>
                            
                            <nav class="hidden lg:flex space-x-2">
                                ${[
                                    { id: 'home', label: 'Home', icon: 'home' },
                                    { id: 'personal', label: 'Personal', icon: 'user' },
                                    { id: 'business', label: 'Business', icon: 'building' },
                                    { id: 'investments', label: 'Investments', icon: 'trending' }
                                ].map(nav => `
                                    <button onclick="setPage('${nav.id}')" class="px-3 py-2 rounded-lg font-semibold text-sm flex items-center space-x-2 ${state.currentPage === nav.id ? 'text-gray-900 bg-gray-100' : 'text-gray-600 hover:bg-gray-50'}">
                                        ${icons[nav.icon]}
                                        <span>${nav.label}</span>
                                    </button>
                                `).join('')}
                            </nav>
                            
                            <div class="flex space-x-2">
                                <button onclick="toggleChat()" class="px-3 py-2 ${state.chatOpen ? 'bg-green-600 text-white' : 'bg-yellow-600 text-black'} rounded-lg font-bold text-xs sm:text-sm">
                                    ${icons.chat}
                                    <span class="hidden sm:inline ml-1">Chat</span>
                                </button>
                                <button onclick="toggleVoice()" class="px-3 py-2 bg-yellow-600 text-black rounded-lg font-bold text-xs sm:text-sm">
                                    ${icons.mic}
                                    <span class="hidden sm:inline ml-1">Voice</span>
                                </button>
                            </div>
                        </div>
                    </div>
                </header>

                ${state.sidebarOpen ? `
                    <div class="lg:hidden bg-white border-b animate-slideUp">
                        <nav class="px-4 py-3 space-y-1">
                            ${[
                                { id: 'home', label: 'Home', icon: 'home' },
                                { id: 'personal', label: 'Personal', icon: 'user' },
                                { id: 'business', label: 'Business', icon: 'building' },
                                { id: 'investments', label: 'Investments', icon: 'trending' }
                            ].map(nav => `
                                <button onclick="setPage('${nav.id}')" class="w-full px-4 py-3 rounded-lg font-semibold text-sm flex items-center space-x-3 ${state.currentPage === nav.id ? 'bg-yellow-600 text-black' : 'text-gray-900 hover:bg-gray-100'}">
                                    ${icons[nav.icon]}
                                    <span>${nav.label}</span>
                                </button>
                            `).join('')}
                        </nav>
                    </div>
                ` : ''}

                <main class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-6 sm:py-8">
                    <div class="bg-gray-900 rounded-2xl border border-yellow-600/20 p-4 sm:p-6 lg:p-8">
                        ${mainContent}
                    </div>
                </main>

                ${state.chatOpen ? `
                    <div class="fixed bottom-4 right-4 w-[90vw] sm:w-96 h-[500px] sm:h-[600px] bg-gray-900 border border-yellow-600/20 rounded-2xl shadow-2xl flex flex-col z-50">
                        <div class="bg-black border-b border-yellow-600/20 rounded-t-2xl px-4 py-3 flex justify-between">
                            <span class="font-bold text-yellow-600">ðŸ¤– AI</span>
                            <button onclick="toggleChat()" class="text-gray-400 hover:text-white">${icons.x}</button>
                        </div>
                        <div id="chatBody" class="flex-1 overflow-y-auto p-4 space-y-3">
                            ${state.chatMessages.map(msg => `
                                <div class="p-3 rounded-xl text-sm ${msg.isUser ? 'bg-yellow-600 text-black ml-auto' : 'bg-yellow-600/10 border-l-4 border-yellow-600 text-white'} max-w-[85%]">
                                    ${!msg.isUser ? '<div class="font-bold text-yellow-600 mb-1">AI:</div>' : ''}
                                    ${msg.message}
                                </div>
                            `).join('')}
                        </div>
                        <div class="border-t border-yellow-600/20 p-3 flex gap-2">
                            <input id="chatInput" onkeypress="if(event.key==='Enter')sendChatMessage()" placeholder="Ask..." class="flex-1 px-3 py-2 bg-black border border-yellow-600/20 rounded text-white text-sm">
                            <button onclick="sendChatMessage()" class="px-4 py-2 bg-yellow-600 text-black rounded font-bold text-sm">Send</button>
                        </div>
                    </div>
                ` : ''}

                ${state.voiceOpen ? `
                    <div class="fixed inset-0 bg-black/80 z-50 flex items-center justify-center p-4">
                        <button onclick="toggleVoice()" class="absolute top-8 right-8 text-white">${icons.x}</button>
                        <div class="text-center">
                            <div class="w-32 h-32 mx-auto mb-6 text-yellow-600">${icons.mic}</div>
                            <h2 class="text-3xl font-bold text-yellow-600">Voice AI</h2>
                        </div>
                    </div>
                ` : ''}
            `;
        }

        window.setPage = (page) => { state.currentPage = page; state.sidebarOpen = false; render(); };
        window.setSubPage = (parent, sub) => { state.currentSubPage[parent] = sub; render(); };
        window.toggleSidebar = () => { state.sidebarOpen = !state.sidebarOpen; render(); };
        window.toggleChat = () => { state.chatOpen = !state.chatOpen; render(); };
        window.toggleVoice = () => { state.voiceOpen = !state.voiceOpen; render(); };
        window.sendChatMessage = sendChatMessage;
        window.scanVIN = scanVIN;

        fetchCryptoPrices();
        fetchStockPrices();
        setInterval(fetchCryptoPrices, 60000);
        setInterval(fetchStockPrices, 30000);
        render();
    </script>
</body>
</html>
